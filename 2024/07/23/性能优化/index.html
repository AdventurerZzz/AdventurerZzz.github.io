<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>性能优化 | Adventurer's blog</title><meta name="author" content="AdventurerZzz"><meta name="copyright" content="AdventurerZzz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前端性能优化前言目前的互联网产品竞争十分激烈，一个网站的打开速度和响应速度是一个很重要的指标，这都会影响用户的留存率和转化率，最终体现为经济效益。现在市场上初中级的前端太多了，学习性能优化的知识也能提高我的个人竞争力和发展空间，所以我打算学习一下这个模块的知识，并在此记录一下我的学习过程。 一丶初识性能优化性能优化其实主要关注点是用户的体验，所以我们需要了解用户的体验点是什么，并且根据网站的生命周">
<meta property="og:type" content="article">
<meta property="og:title" content="性能优化">
<meta property="og:url" content="http://example.com/2024/07/23/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/index.html">
<meta property="og:site_name" content="Adventurer&#39;s blog">
<meta property="og:description" content="前端性能优化前言目前的互联网产品竞争十分激烈，一个网站的打开速度和响应速度是一个很重要的指标，这都会影响用户的留存率和转化率，最终体现为经济效益。现在市场上初中级的前端太多了，学习性能优化的知识也能提高我的个人竞争力和发展空间，所以我打算学习一下这个模块的知识，并在此记录一下我的学习过程。 一丶初识性能优化性能优化其实主要关注点是用户的体验，所以我们需要了解用户的体验点是什么，并且根据网站的生命周">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imgapi.xl0408.top/index.php?9060">
<meta property="article:published_time" content="2024-07-23T02:03:16.000Z">
<meta property="article:modified_time" content="2024-12-20T03:40:08.217Z">
<meta property="article:author" content="AdventurerZzz">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imgapi.xl0408.top/index.php?9060"><link rel="shortcut icon" href="data:image/png;base64,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"><link rel="canonical" href="http://example.com/2024/07/23/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.14.0-b3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>(()=>{
      const saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      
      window.btf = {
        saveToLocal: saveToLocal,
        getScript: (url, attr = {}) => new Promise((resolve, reject) => {
          const script = document.createElement('script')
          script.src = url
          script.async = true
          script.onerror = reject
          script.onload = script.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            script.onload = script.onreadystatechange = null
            resolve()
          }

          Object.keys(attr).forEach(key => {
            script.setAttribute(key, attr[key])
          })

          document.head.appendChild(script)
        }),

        getCSS: (url, id = false) => new Promise((resolve, reject) => {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = url
          if (id) link.id = id
          link.onerror = reject
          link.onload = link.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            link.onload = link.onreadystatechange = null
            resolve()
          }
          document.head.appendChild(link)
        }),

        addGlobalFn: (key, fn, name = false, parent = window) => {
          const pjaxEnable = false
          if (!pjaxEnable && key.startsWith('pjax')) return

          const globalFn = parent.globalFn || {}
          const keyObj = globalFn[key] || {}
    
          if (name && keyObj[name]) return
    
          name = name || Object.keys(keyObj).length
          keyObj[name] = fn
          globalFn[key] = keyObj
          parent.globalFn = globalFn
        }
      }
    
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode
      
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })()</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '性能优化',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-20 11:40:08'
}</script><link rel="stylesheet" href="/css/mouse.css"><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loading-box"><div class="cat__scene"><div class="cat__main"><div class="cat__body"></div><div class="cat__body"></div><div class="cat__tail"></div><div class="cat__head"></div></div></div></div><script>(()=>{
    var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').style.transition = 'opacity 3s ease 0s'
    document.getElementById('loading-box').style.opacity = '0'
    setTimeout(function(){
      document.getElementById('loading-box').classList.add("loaded")
    }, 3000);
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').style.transition = '';
    document.getElementById('loading-box').style.opacity = '1'
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> {preloader.endLoading()})
setTimeout(function(){preloader.endLoading();}, 5000);
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/img/favicon.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%85%B3%E4%BA%8E/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Adventurer's blog"><span class="site-name">Adventurer's blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%85%B3%E4%BA%8E/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">性能优化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-23T02:03:16.000Z" title="发表于 2024-07-23 10:03:16">2024-07-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-20T03:40:08.217Z" title="更新于 2024-12-20 11:40:08">2024-12-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="性能优化"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="前端性能优化"><a href="#前端性能优化" class="headerlink" title="前端性能优化"></a>前端性能优化</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>目前的互联网产品竞争十分激烈，一个网站的打开速度和响应速度是一个很重要的指标，这都会影响用户的留存率和转化率，最终体现为经济效益。现在市场上初中级的前端太多了，学习性能优化的知识也能提高我的个人竞争力和发展空间，所以我打算学习一下这个模块的知识，并在此记录一下我的学习过程。</p>
<h2 id="一丶初识性能优化"><a href="#一丶初识性能优化" class="headerlink" title="一丶初识性能优化"></a>一丶初识性能优化</h2><p>性能优化其实主要关注点是用户的体验，所以我们需要了解用户的体验点是什么，并且根据网站的生命周期来进行优化。主要参照了 RAIL 性能模型的四个方面：</p>
<ul>
<li><code>响应(Response)</code>：用户交互的响应时间</li>
<li><code>动画(Animation)</code>：用户体验的流畅度</li>
<li><code>空闲(Idle)</code>：利用空闲时间来处理可延迟任务</li>
<li><code>加载(Load)</code>：加载关键渲染路径</li>
</ul>
<h3 id="常见的优化性能的步骤一般分为三步"><a href="#常见的优化性能的步骤一般分为三步" class="headerlink" title="常见的优化性能的步骤一般分为三步:"></a>常见的优化性能的步骤一般分为三步:</h3><ol>
<li>首先<strong>量化</strong>网站的性能表现，可以通过<strong>Chrome</strong>浏览器的<strong>Performance</strong>模块或者使用<strong>Lighthouse</strong>插件来查看网站的性能表现；</li>
<li>然后立足于网站的<strong>生命周期</strong>，找出性能表现差的原因；</li>
<li>最后进行技术改造和优化性能。</li>
</ol>
<hr>
<h2 id="二丶前端页面的生命周期"><a href="#二丶前端页面的生命周期" class="headerlink" title="二丶前端页面的生命周期"></a>二丶前端页面的生命周期</h2><p>前端有一道很经典的面试题:从浏览器地址栏输入 URL 后，到页面渲染出来，整个过程发生了什么?这道题其实考察的是面试者对前端页面生命周期和前端性能优化方面的理解。这里就整个流程划分为以下几个阶段并分析其中存在的性能优化点：</p>
<ol>
<li><code>浏览器接收到 URL，到网络请求线程的开启。 </code></li>
<li><code>一个完整的 HTTP 请求的发出。</code></li>
<li><code>服务器接收到请求并转到具体的处理后台。</code></li>
<li><code>前后台之间的 HTTP 交互和涉及的缓存机制。</code></li>
<li><code>浏览器接收数据包后的关键渲染路径。</code></li>
<li><code>JS 引擎的解析过程。</code></li>
</ol>
<hr>
<h3 id="网络请求线程开启"><a href="#网络请求线程开启" class="headerlink" title="网络请求线程开启"></a>网络请求线程开启</h3><p>浏览器接收到 URL 后，会开启多个进程，其中有浏览器主进程、GPU 进程、插件进程、网络进程、渲染进程(浏览器内核)。渲染进程中有多个子线程，包括 JS 引擎线程、GUI 渲染线程、事件触发线程、定时器触发器线程、异步 HTTP 请求线程等。所发起的网络请求就是从这个进程开启的。</p>
<hr>
<h3 id="建立-HTTP-请求"><a href="#建立-HTTP-请求" class="headerlink" title="建立 HTTP 请求"></a>建立 HTTP 请求</h3><p>在开启网络请求线程时，URL 会被当成参数传入并处理。<br>首先通过 DNS 解析，将域名转换为 IP 地址，然后建立通往该服务器地址的路径。如图 2.1 所示为 DNS 解析过程。</p>
<h4 id="DNS-解析"><a href="#DNS-解析" class="headerlink" title="DNS 解析"></a>DNS 解析</h4><ol>
<li>首先查询浏览器自身的 DNS 缓存；</li>
<li>如果没有命中，则查询系统自身的 DNS 缓存；</li>
<li>如果还未找到，则从本地的 hosts 文件中查询；</li>
<li>如果在本地主机未找到，则向本地域名服务器查询；</li>
<li>如果本地域名服务器未找到，则会采取迭代的方式向根域名服务器、COM 域名顶级服务器和权限域名查询；<br><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/06f23ef6c8db46e59049279a0ce9cd20.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYmFuZ3NoYW8xOTg5,size_20,color_FFFFFF,t_70,g_se,x_16"><img src="/img/loading.gif" data-original="/img/dns.png" alt="DNS解析图" title="DNS解析图"></a><br>图 2.1 DNS 解析过程</li>
</ol>
<p><strong>所以可以看出，DNS 解析是一个耗时的过程，如果解析域名过多，就会导致性能问题。这个地方能被当成一个可选择的优化点。</strong></p>
<hr>
<h3 id="前后端的交互"><a href="#前后端的交互" class="headerlink" title="前后端的交互"></a>前后端的交互</h3><p>当可以通过 HTTP 协议进行前后端通信的时候，往往并未是浏览器和确定 IP 地址的服务器进行直接通信，通过会在中间加入<strong>反向代理服务器</strong>。</p>
<h4 id="反向代理服务器"><a href="#反向代理服务器" class="headerlink" title="反向代理服务器"></a>反向代理服务器</h4><p>反向代理服务器一般通过集群的方式，将多个应用服务器结合，然后提供给客户端用户使用。它会根据用户的请求，从后端服务器上获取资源后返回给客户端，如图 2.1 所示，作用如下：</p>
<ul>
<li><p><code>负载均衡</code></p>
</li>
<li><p><code>完全防火墙</code></p>
</li>
<li><p><code>加密及 SSL 加速</code></p>
</li>
<li><p><code>数据压缩</code></p>
</li>
<li><p><code>解决跨域</code></p>
</li>
<li><p><code>对静态资源缓存</code></p>
<p><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/67258e57480642c7adc184ab2b58672d.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMzEyMDQ5,size_16,color_FFFFFF,t_70"><img src="/img/loading.gif" data-original="/img/proxy.png" alt="反向代理服务器图" title="反向代理服务器图"></a><br> 图 2.1 DNS 解析过程</p>
</li>
</ul>
<hr>
<h4 id="浏览器缓存"><a href="#浏览器缓存" class="headerlink" title="浏览器缓存"></a>浏览器缓存</h4><p>在前后端交互中，使用浏览器缓存可以使性能得到显著提升。具体的缓存策略为两种:<code>强缓存</code>和<code>协商缓存</code>。</p>
<p><strong>强缓存</strong>是当浏览器通过响应头判断本地缓存未过期时，直接读取本地缓存，不再发起 HTTP 请求，通过设置<code>Cache-Control</code>字段中的<code>max-age</code>属性值来设置缓存过期时间。</p>
<p><strong>协助缓存</strong>是需要浏览器向服务器发起 HTTP 请求，来判断浏览器本地缓存的文件是否被修改。具体过程是判断浏览器请求头中的<code>If-Modified-Since</code>字段，与服务器端的<code>e-tag</code>是否匹配，如果本地缓存文件未修改，服务器返回<code>304</code>状态码，浏览器直接读取本地缓存。如图 2.2 所示。<br> <a target="_blank" rel="noopener" href="https://image-static.segmentfault.com/379/147/3791479945-f4c940afe80caf28_fix732"><img src="/img/loading.gif" data-original="/img/huancun.png" alt="缓存" title="缓存"></a><br> 图 2.2 缓存过程</p>
<p><strong>使用浏览器缓存可以有效地减少 HTTP 请求次数，以及资源的读取和减少服务器压力，从而提升性能。</strong></p>
<hr>
<h3 id="关键渲染路径"><a href="#关键渲染路径" class="headerlink" title="关键渲染路径"></a>关键渲染路径</h3><p>当浏览器接收读取到 HTML 文件后，会进行如下操作：</p>
<ol>
<li>解析 HTML 文件，将 HTML 文件按照<code>UTF-8</code>编码规则将原始字节转化为字符，然后再按照<code>W3C</code>标准进行构建生成<code>DOM</code>树。</li>
<li>同样的操作，解析 CSS 文件，生成<code>CSSOM</code>树。</li>
<li>接下来将两个对象模型合并为渲染树，在<code>CSSOM</code>中为所有可见的<code>DOM</code>节点找到对应的规则并应用，计算元素的位置与大小，将节点转化为屏幕上的实际像素。</li>
</ol>
<p><strong>如果 HTML 文件中<code>DOM</code>节点过多过深，样式复杂，那么浏览器要处理的任务就越多，绘制的时间久越长，直接影响了首屏加载速度。</strong></p>
<p><strong>同时，当页面渲染完成后，用户在进行交互时，也可能通过<code>JavaScript</code>代码修改的<code>DOM</code>节点，这时浏览器需要重新绘制，这样也会影响性能。所以这也是可优化点。</strong></p>
<hr>
<h2 id="三丶图像优化"><a href="#三丶图像优化" class="headerlink" title="三丶图像优化"></a>三丶图像优化</h2><p>在如今的各类 Web 项目中，其实图像资源的使用占比也越来越大，打开一个网站，你会发现有大量的图片请求，如果巨量的访问请求会引发传输带宽的挑战，请求大尺寸图片需要过长的等待时间，所以，如何优化图像资源，是前端性能优化中一个很重要的点。这部分着重讨论一下图像的<strong>选取和使用</strong>。</p>
<hr>
<h3 id="3-1-图像基础"><a href="#3-1-图像基础" class="headerlink" title="3.1 图像基础"></a>3.1 图像基础</h3><p>图像资源优化的根本思想就是：<strong>压缩</strong>，其本质就是用更小的资源开销来完成图像的传输和展示。</p>
<hr>
<h4 id="矢量图"><a href="#矢量图" class="headerlink" title="矢量图"></a>矢量图</h4><p>矢量图中的图片是由线条和曲线组成的，这些线条和曲线都是由计算得到的。它的优点是能够在任何缩放比例下呈现出细节同样清晰的展示效果，缺点是对细节的展示不够。如果想要实现复杂的图像，所得文件大得离谱，而且达不到想要的效果。<strong>它适合文本、logo、控件图标以及二维码等构图形状简单的几何图形</strong></p>
<h4 id="位图"><a href="#位图" class="headerlink" title="位图"></a>位图</h4><p>位图是通过对一个矩阵中的栅格进行编码来表示图像的，每个栅格表示一个特定颜色，图像由多个栅格像素点组成，那么位图的整体显示效果就会越逼真。它的优点是对于复杂的照片能提供较为真实的细节体验，缺点是显示效果会收到分辨率的影响。<strong>它适合呈现复杂像素组成的图形</strong>。</p>
<hr>
<h3 id="3-2-图像格式"><a href="#3-2-图像格式" class="headerlink" title="3.2 图像格式"></a>3.2 图像格式</h3><p>图像文件格式通常有<code>JPEG</code>、<code>PNG</code>、<code>GIF</code>、<code>webp</code>，<code>SVG</code>等。根据它们不同的特点，应该在适合它们的场景选取。</p>
<hr>
<h4 id="JPEG"><a href="#JPEG" class="headerlink" title="JPEG"></a>JPEG</h4><p><code>JPEG</code>是一种<strong>有损压缩算法</strong>的图像格式，它通过去除冗余图像和色彩数据来获得<strong>较高的压缩率</strong>，同时还能获得较高的图像质量。</p>
<p>它通常有两种压缩模式，一种是<code>基线模式</code>，一种是<code>渐进式模式</code>。<code>基线模式</code>是自上而下进行逐渐加载的，而<code>渐进式模式</code>是将图像文件分多次扫描，首先展示一个低质量模糊的图像，然后随着扫描次数的增加，不断提高清晰度。</p>
<p><strong>在选择哪种压缩模式时，应该考虑图像的大小，因为渐进式模式会增加重复检索开销，文件太小就没必要使用渐进式模式。但是目前通常都是使用渐进式模式，一般的使用场景是背景图、轮播图、商品的 banner 图。</strong></p>
<hr>
<h5 id="创建渐进式-JPEG"><a href="#创建渐进式-JPEG" class="headerlink" title="创建渐进式 JPEG"></a>创建渐进式 JPEG</h5><p>可以通过构建工具来自动化完成，通过如下代码可以将工作加入 gulp 处理管道：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> imagemin = <span class="built_in">require</span>(<span class="string">&quot;gulp-imagemin&quot;</span>);</span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;imagemin&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;./src/images/*.jpg&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">imagemin</span>(&#123;</span><br><span class="line">        <span class="attr">progressive</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./dist/images&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这里还有一些其他 JPEG 编码方式，如<code>MozJPEG</code>、<code>Guetzli</code> 等，具体可以参考<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/imagemin">imagemin</a>。</p>
<hr>
<h4 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h4><p><code>GIF</code>通常用于一些小图标或者 Logo，当下一般在需要使用动画时会使用<code>GIF</code>。</p>
<hr>
<h5 id="GIF-动画优化"><a href="#GIF-动画优化" class="headerlink" title="GIF 动画优化"></a>GIF 动画优化</h5><p>由于动画包含了许多静态帧，并且每个静态帧图像上的内容在相邻的不同帧上很相似，<strong>所以可以通过工具移除动画里连续帧中的像素信息</strong>，这里通过<code>GIFSicle</code>工具来实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; execFile &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> gifsicle = <span class="built_in">require</span>(<span class="string">&quot;gifsicle&quot;</span>);</span><br><span class="line"><span class="title function_">execFile</span>(gifsicle, [<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;output.gif&quot;</span>, <span class="string">&quot;input.gif&quot;</span>], <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;动画压缩完成&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h4><p><code>PNG</code>是无损压缩的高保真图片格式，它的优点是可以保持图像的透明效果，并且<br>对线条的处理更加细腻，增强了色彩的表现力，<strong>但是缺点是文件体积较大</strong>。</p>
<hr>
<h5 id="优化-PNG"><a href="#优化-PNG" class="headerlink" title="优化 PNG"></a>优化 PNG</h5><p><code>PNG</code>图片有个优点，它能够通过增添一些自定义的”块”来实现额外的功能，但是对于 Web 来说，部分多余的块会自动被忽略，所以可以通过工具来移除这些无用的块。<br>因此可以使用 pngcrush 对这些多余的块进行删除压缩，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> imagemin = <span class="built_in">require</span>(<span class="string">&quot;imagemin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> imageminPngcrush = <span class="built_in">require</span>(<span class="string">&quot;imagemin-pngcrush&quot;</span>);</span><br><span class="line"><span class="title function_">imagemin</span>([<span class="string">&quot;src/images/*.png&quot;</span>], <span class="string">&quot;dist/images&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">imageminPngcrush</span>()],</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;PNG 完成图像优化&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>其中，<code>imageminPngcrush</code>中可以带一些参数进行压缩。</p>
<ul>
<li><code>rem alla</code>:删除所有块，保留控制 alpha 透明通道的块。</li>
<li><code>reduce</code>：尝试减少调色板使用的颜色数量。</li>
</ul>
<hr>
<h4 id="WEBP"><a href="#WEBP" class="headerlink" title="WEBP"></a>WEBP</h4><p><code>Webp</code>具有多个优异的特性，包括：较高的视觉体验，而且优秀的压缩率，并且支持动画和透明度。但是，和所有新技术一样，不可避免会有一些兼容性问题。所以在使用的时候应该考虑浏览器的兼容问题。</p>
<hr>
<h5 id="WebP-转化"><a href="#WebP-转化" class="headerlink" title="WebP 转化"></a>WebP 转化</h5><p>最好使用构建工具辅助完成，比如通过 npm 安装<code>webp-loader</code>，然后在<code>webpack.config.js</code>中配置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loader</span>: [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif)$/i</span>,</span><br><span class="line">    <span class="attr">loader</span>: [<span class="string">&quot;file-loader&quot;</span>, <span class="string">&quot;webp-loader?&#123;quality:13&#125;&quot;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h4><p><code>Base64</code>并不是一种图像文件格式，而是一种用于传输 8 位字节码的编码方式。它通过将编码直接写入 HTML 或 CSS 中实现图像的展示。一般将<code>Base64</code>编码的图片作为静态资源引入，减少请求次数。</p>
<p><strong>浏览器会自动解析该编码并展示出图像，而无须发起任何关于该图像的 URL，这就是<code>Base64</code>的优点，同时也有一定缺点，图像大小会膨胀四分之三。下面是一些使用<code>Base64</code>编码的建议：</strong></p>
<ul>
<li>图像文件的实际尺寸是否很小</li>
<li>图像文件的更新频率是否很低，以避免在使用<code>Base64</code>时，增加多的维护成本。</li>
</ul>
<hr>
<h3 id="3-3-使用建议"><a href="#3-3-使用建议" class="headerlink" title="3.3 使用建议"></a>3.3 使用建议</h3><p>这部分给出一些在实际的开发条件下的优化建议以及注意事项。</p>
<h4 id="CSS-Sprite"><a href="#CSS-Sprite" class="headerlink" title="CSS Sprite"></a>CSS Sprite</h4><p>这个技术就是我们常说的雪碧图，通过将多个小图标拼成一张大图，然后通过 CSS 的 background-position 属性来定位到对应的小图标。<br><strong>这个技术在我看来已经淘汰了，由于以下缺点：</strong></p>
<ol>
<li>如果图标变化了，那么需要重新拼接雪碧图，而且雪碧图会很大，而且需要服务器支持。</li>
<li>随着图标增多，浏览器加载图片的时间也会增加。</li>
</ol>
<h4 id="Web-字体"><a href="#Web-字体" class="headerlink" title="Web 字体"></a>Web 字体</h4><p><code>Web</code>字体，通过<code>@font-face</code>标签引入，然后通过<code>@font-family</code>属性来使用。在我看来一些应该图标 ICON 的都应该使用<code>Web</code>字体，因为<code>Web</code>字体的图标，可以更好的适应不同尺寸的设备，而且能够保证图标质量。</p>
<p><strong>同时由于矢量图标打包到一个<code>Web</code>字体文件中，这个文件的大小通常不会很大，这个时候将字体格式文件编译为<code>Base64</code>编码，可以减少请求次数，这样的优化可以大幅减少页面加载时间。以下是操作建议：</strong></p>
<ol>
<li><strong>在 iconfont 下载的 CSS 文件中将代码修改如下文</strong></li>
</ol>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@font-face</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;iconfont&quot;</span>; <span class="comment">/* Project id 4381127 */</span></span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&quot;data:font/truetype;charset=utf-8;base64,Base64String&quot;</span>) <span class="built_in">format</span>(<span class="string">&quot;truetype&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>将 iconfont 文件的 TTF 文件转化为 Base64 编码，并且将生成的 Base64 编码替换掉@font-face 中的 Base64String</strong></li>
<li><strong>在 App.vue 中引入 iconfont.css</strong></li>
</ol>
<p><strong>这里是参考的网址</strong><a target="_blank" rel="noopener" href="https://blog.csdn.net/yanyunqi02/article/details/130655841">icon 转 base64 流程。</a></p>
<hr>
<h2 id="四丶加载优化"><a href="#四丶加载优化" class="headerlink" title="四丶加载优化"></a>四丶加载优化</h2><p>第三章讲了图片的格式选取以及本身资源压缩优化，其实这还无法满足期望，我们还需要在资源加载的过程中进行优化，主要是三个小点：</p>
<ol>
<li><strong>资源的优先级</strong></li>
<li><strong>延迟加载</strong></li>
<li><strong>预加载</strong></li>
</ol>
<hr>
<h3 id="4-1-图像延迟加载"><a href="#4-1-图像延迟加载" class="headerlink" title="4.1 图像延迟加载"></a>4.1 图像延迟加载</h3><p>延迟加载是指在首次打开网站时。应当尽量只加载首屏内容所包含的资源，而首屏之外涉及的图片或视频，可以等用户滚动到该区域时才加载。</p>
<p>图像的延迟加载其实就是我们平时所了解的图片懒加载，这里有很多方法可以实现懒加载：</p>
<ul>
<li><strong>传统方式</strong>——通过监听 scroll 事件和 resize 事件，判断图片是否进入可视区域，然后将<code>data-src</code>上面的<code>url</code>替换为<code>src</code>，这种方法优点是浏览器兼容性好，缺点是持续监听十分消耗性能。</li>
<li><code>Intersection Observer</code>**(推荐)**——通过 IntersectionObserver API，判断图片是否进入可视区域，然后加载图片，原理类似传统方式，优点是简洁高效，缺点是浏览器可能不兼容(目前来说出现情况很少),以下是代码实现:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取img所有img标签的lazy类</span></span><br><span class="line"><span class="keyword">const</span> lazyImages = [].<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;img.lazy&quot;</span>));</span><br><span class="line"><span class="comment">//当进入视口判断距离时，加载图片</span></span><br><span class="line"><span class="keyword">let</span> lazyImageObserver = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(</span><br><span class="line">  <span class="function">(<span class="params">entries</span>) =&gt;</span> &#123;</span><br><span class="line">    entries.<span class="title function_">forEach</span>(<span class="function">(<span class="params">entry</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (entry.<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> lazyImage = entry.<span class="property">target</span>;</span><br><span class="line">        lazyImage.<span class="property">src</span> = lazyImage.<span class="property">dataset</span>.<span class="property">src</span>;</span><br><span class="line">        lazyImage.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;lazy&quot;</span>);</span><br><span class="line">        <span class="comment">//取消监听</span></span><br><span class="line">        lazyImageObserver.<span class="title function_">unobserve</span>(lazyImage);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//这里是控制图片距离视口的距离来加载图片</span></span><br><span class="line">  &#123; <span class="attr">rootMargin</span>: <span class="string">&quot;0px 0px 300px 0px&quot;</span> &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">//监听</span></span><br><span class="line">lazyImages.<span class="title function_">forEach</span>(<span class="function">(<span class="params">lazyImage</span>) =&gt;</span> &#123;</span><br><span class="line">  lazyImageObserver.<span class="title function_">observe</span>(lazyImage);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>原生延迟</strong>——通过 <code>img</code> 标签的 <code>lazy</code> 属性实现懒加载,这种方式目前是最简洁的，但兼容不是很好，这里不多赘述。</p>
<hr>
<h3 id="4-2-加载注意事项"><a href="#4-2-加载注意事项" class="headerlink" title="4.2 加载注意事项"></a>4.2 加载注意事项</h3><p>对于图像的延迟加载，从理论上必然会对性能产生重要的影响，但在实现过程中有许多细节需要注意，稍有差池可能会造成负面结果。</p>
<h4 id="4-2-1-资源占位"><a href="#4-2-1-资源占位" class="headerlink" title="4.2.1 资源占位"></a>4.2.1 资源占位</h4><p>当延迟加载的资源尚未加载完成时，应该显示一个有相同尺寸的占位图像，如果不使用占位图像，那么图像延迟显示出来后，尺寸更改可能会使页面布局出现偏移。<br>这个现象不仅带来负面体验，更严重的会造成<strong>页面的重绘和回流，影响页面性能。</strong>所以建议占位图像应该与延迟加载的资源尺寸相同，而且可以采用<code>Base64</code>图片。</p>
<hr>
<h3 id="4-3-资源优先级"><a href="#4-3-资源优先级" class="headerlink" title="4.3 资源优先级"></a>4.3 资源优先级</h3><p>浏览器向网络请求到所有数据，本非每个字节都具有相同的优先级或重要性。一般浏览器会先加载<code>CSS</code>文件，然后再加载<code>JS</code>文件，即便如此也不能保证这个加载顺序是准确的。</p>
<h4 id="4-3-1-优先级"><a href="#4-3-1-优先级" class="headerlink" title="4.3.1 优先级"></a>4.3.1 优先级</h4><p>浏览器基于自身的启发式算法，会对资源的重要性进行划分等级，通常从低到高分为：<code>Lowest</code>、<code>Low</code>、<code>High</code>、<code>Highest</code>。<br>当资源对用户至关重要却被分到了过低的优先级时，这个时候就可以尝试<strong>预加载</strong>,<strong>预连接</strong>,<strong>预提取</strong>等方式来进行优化。</p>
<h4 id="4-3-2-预加载"><a href="#4-3-2-预加载" class="headerlink" title="4.3.2 预加载"></a>4.3.2 预加载</h4><p>使用<code>link</code>标签告诉浏览器当前指定的资源具有更高优先级：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">&quot;perload&quot;</span> <span class="keyword">as</span>=<span class="string">&#x27;style&#x27;</span> href=<span class="string">&quot;styles.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-3-预连接"><a href="#4-3-3-预连接" class="headerlink" title="4.3.3 预连接"></a>4.3.3 预连接</h4><p>与 DNS 预解析类似，preconnect 不仅完成 DNS 预解析，同时还将进行 TCP 握手和建立传输层协议。可以这样使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">&quot;preconnect&quot;</span>  href=<span class="string">&quot;http://example.com&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-4-预获取"><a href="#4-3-4-预获取" class="headerlink" title="4.3.4 预获取"></a>4.3.4 预获取</h4><p>如果我们确定某个资源将来一定会被使用到，我们可以让浏览器预先请求该资源并放入浏览器缓存中，也就是说如果我们猜测用户接下来将要访问哪个具体的资源，那就可以用 prefetching 来预加载确定的资源了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">&quot;prefetch&quot;</span>  href=<span class="string">&quot;image.png&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="五丶书写高性能的代码"><a href="#五丶书写高性能的代码" class="headerlink" title="五丶书写高性能的代码"></a>五丶书写高性能的代码</h2><p>每当页面响应用户的交互时，可能会涉及成千上万行<code>JavaScript</code>的代码执行,高性能网站对这个过程的要求是不仅执行顺畅吴 BUG，能对用户的操作能更快响应，而且在执行完任务的同时占用更少的资源。所以要书写高性能的<code>JavaScript</code>代码能够在用户的浏览器中准确且高效地执行，这一点至关重要。</p>
<hr>
<h3 id="5-1-数据存取"><a href="#5-1-数据存取" class="headerlink" title="5.1 数据存取"></a>5.1 数据存取</h3><p>在 JavaScript 中，数据的存取是非常重要的，因为它决定了代码的性能。如果能在处理数据以前，更快地读取到数据，那么会对代码的执行产生积极得到作用。</p>
<h4 id="5-1-1-数据存取方式"><a href="#5-1-1-数据存取方式" class="headerlink" title="5.1.1 数据存取方式"></a>5.1.1 数据存取方式</h4><p><code>JavaScript</code> 中数据的存取方式有很多，比如：</p>
<ul>
<li><strong>直接字面量：</strong> 字面量不存储在特定位置也不需要索引，仅代表自身。它们包括布尔值、数字、字符串、对象、数组、函数、null、undefined 及正则表达式。</li>
<li><strong>变量：</strong> 通过关键字<code>const/let/var</code>定义的数据存储单元。</li>
<li><strong>数组元素：</strong> 存储在数组对象内部，通过数组下标数字进行索引。</li>
<li><strong>对象属性：</strong> 存储在对象内部，通过对象的字符串名称进行索引。</li>
</ul>
<p>从读取速度来看，直接字面量与变量是非常快的，相比之下数组元素和对象属性由于需要索引，其读取速度也会因其组成结构的复杂度越高而变量越慢。</p>
<h4 id="5-1-2-作用域和作用域链"><a href="#5-1-2-作用域和作用域链" class="headerlink" title="5.1.2 作用域和作用域链"></a>5.1.2 作用域和作用域链</h4><p>对于能够访问到的数据，其在不同作用域中的查询也有先后顺序。<code>JavaScript</code>引擎会在页面加载后创建一个全局的作用域，然后将碰到的要执行的函数创建对应的作用域，最终不同的块级作用域和嵌套在内部的函数作用域，会形成一个作用域堆栈。</p>
<hr>
<h4 id="5-1-3-实战经验"><a href="#5-1-3-实战经验" class="headerlink" title="5.1.3 实战经验"></a>5.1.3 实战经验</h4><h5 id="对局部变量的使用"><a href="#对局部变量的使用" class="headerlink" title="对局部变量的使用"></a>对局部变量的使用</h5><p>如果一个非部门变量在函数中的使用次数不止一次，那么最好使用局部变量进行存储。代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;target&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> imgs = <span class="variable language_">document</span>.<span class="title function_">getElementByClassName</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; imgs.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> img = imags[i];</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    target.<span class="title function_">appendChild</span>(img);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在函数 process 中，通过<code>document</code>的两个不同的成员函数分别获取了特定的元素和元素列表，然后进行一些省略相关处理流程的操作。<code>document</code>属于全局作用域的对象，位于作用域链的最深处，在标识符解析过程中会被最后解析到，而且它在次函数中使用不止一次，所以可以考虑将其声明为一个局部变量，以提升其在作用域链中的查找顺序。</p>
<p>另外一点，计算类名为 img 的所有 DOM 节点数量的语句<code>img.length</code>执行不止一遍。当查询所得的 DOM 节点列表存储<br>到 imgs 中后，每次通过属性名或索引读取 imgs 的属性时，DOM 都会重复执行一次对页面元素的查找，这个过程本身会很缓慢。</p>
<p>将上述代码优化后的写法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> doc = <span class="variable language_">document</span>;</span><br><span class="line">  <span class="keyword">const</span> target = doc.<span class="title function_">getElementById</span>(<span class="string">&quot;target&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> imgs = doc.<span class="title function_">getElementByClassName</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> len = imgs.<span class="property">length</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> img = imags[i];</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    target.<span class="title function_">appendChild</span>(img);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="警惕闭包的使用"><a href="#警惕闭包的使用" class="headerlink" title="警惕闭包的使用"></a>警惕闭包的使用</h5><p>闭包的特性使函数能够访问局部变量之外的数据，例如下面的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">mkFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> name = <span class="string">&quot;Tian&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">showName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> myFunc = <span class="title function_">mkFunc</span>();</span><br><span class="line"><span class="title function_">myFunc</span>();</span><br></pre></td></tr></table></figure>

<p>showName()函数是一个闭包，它在 mkFunc()函数执行时被创建，并能访问 mkFunc()函数的局部变量 name。</p>
<p>一般的函数执行完成后，会被销毁，但是闭包会阻止这种情况的发生，因为它会引用父函数的局部变量，从而延长了局部变量的生命周期。这意味着使用闭包可能会带来更大的内存开销及内存泄漏的影响。</p>
<h3 id="5-2-流程控制"><a href="#5-2-流程控制" class="headerlink" title="5.2 流程控制"></a>5.2 流程控制</h3><p>本节从常见的条件与循环的流程控制出发，对代码的执行流程进行优化。</p>
<h4 id="5-2-1-条件判断"><a href="#5-2-1-条件判断" class="headerlink" title="5.2.1 条件判断"></a>5.2.1 条件判断</h4><h5 id="if-else-和-switch"><a href="#if-else-和-switch" class="headerlink" title="if-else 和 switch"></a>if-else 和 switch</h5><p>在代码中，<code>if-else</code> 和<code>switch</code> 都是条件判断的语句，但是它们的执行效率是不同的。通常对多个离散值的取值条件判断，使用<code>switch</code>会比<code>if-else</code>具有更高的性能表现。<code>switch</code>可以清晰地表明判断条件和返回值之间的对应关系，同时<code>switch</code>还可以将不同的条件取值的处理逻辑集中在一起，提高代码的可读性。<br>如果只有一两个条件判断，通常<code>if-else</code> 处理条件的时间会比<code>switch</code>更快，当判断条件多到两个以上时，在大多数时候，<code>switch</code> 会比<code>if-else</code> 更快。</p>
<hr>
<h5 id="if-else-优化"><a href="#if-else-优化" class="headerlink" title="if-else 优化"></a>if-else 优化</h5><p>如果程序最终的执行路径是最后一个<code>else if</code>子语句，那么当执行到此处之前，其余所有条件判断程序都要经历一遍，这就会造成大量的性能浪费。<br>所以可以优化的方式是，<strong>开发者可以预先估计条件被匹配到的频率，按照频率的降序顺序来排序<code>if-else</code>语句，可以让匹配频率高的条件更快执行，从而在整体上降低程序花费在条件判断上的时候，比如：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (value === <span class="number">8</span>) &#123;</span><br><span class="line">  <span class="comment">//匹配到8的概率最高</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value === <span class="number">7</span>) &#123;</span><br><span class="line">  <span class="comment">//匹配到7的概率仅此于8</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value === <span class="number">6</span>) &#123;</span><br><span class="line">  <span class="comment">//匹配到6的概率最低</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">//...不需要对6额外的条件判断</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="数组索引和对象属性"><a href="#数组索引和对象属性" class="headerlink" title="数组索引和对象属性"></a>数组索引和对象属性</h5><p>除了<code>if-else</code>语句和<code>switch</code>语句,<strong>利用数组的索引查询或对象的属性查询页可以达到类似条件判断的目的</strong>,代码如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条件映射数组</span></span><br><span class="line"><span class="keyword">const</span> valueArry = [value0, value1, value2, value3, value4];</span><br><span class="line"><span class="comment">//提取对应数组索引的处理</span></span><br><span class="line">valueArry[value];</span><br></pre></td></tr></table></figure>

<p>可以将对象或者函数统一处理进数组中，那么便可将条件匹配的值映射到数组中，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条件映射数组</span></span><br><span class="line"><span class="keyword">const</span> valueMap = &#123;</span><br><span class="line">  <span class="attr">condition0</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">condition1</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">condition2</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//提取对应数组属性的处理</span></span><br><span class="line">valueMap[value];</span><br></pre></td></tr></table></figure>

<p>当匹配条件的数量较小时，并不适合使用这种基于数组或对象的查找方式，<strong>因为查找数组或映射对象属性值往往比执行少量的条件判断语句要慢，只有当取值范围变得非常大时，这种查找方式的性能优势才会凸显处理。</strong></p>
<hr>
<h5 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h5><p>策略模式就是定义一系列流程或者算法，将每一个算法封装起来，并且使他们可以互相替换。其目的是将算法的使用和实现分离。一个基于策略模式的程序通常会包含两个部分，一部分是一组策略类，其中包含一系列具体的处理算法，有点类似于包含不同处理过程的映射对象<code>valueMao</code>，另一部分是环境类，上下文对象，其会根据客户端的选择，动态地配置一个策略类,即完成流程控制中条件匹配的部分。<br>策略模式很好地利用了组合、委托及多态等技术思想，有效地避免了类型<code>if-else</code>等多条件选择语句。同时它完美支持了开放——封闭原则，将处理算法封装在独立的策略中，使其易于理解、切换和扩展。代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//奖金发放策略类</span></span><br><span class="line"><span class="keyword">const</span> strategies = &#123;</span><br><span class="line">  <span class="attr">S</span>: <span class="function">(<span class="params">salary</span>) =&gt;</span> salary * <span class="number">4</span>,</span><br><span class="line">  <span class="attr">A</span>: <span class="function">(<span class="params">salary</span>) =&gt;</span> salary * <span class="number">3</span>,</span><br><span class="line">  <span class="attr">B</span>: <span class="function">(<span class="params">salary</span>) =&gt;</span> salary * <span class="number">2</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//计算具体奖金</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">calculateBonus</span>(<span class="params">level, salary</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> strategies[level](salary);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="5-3-字符串拼接"><a href="#5-3-字符串拼接" class="headerlink" title="5.3 字符串拼接"></a>5.3 字符串拼接</h3><p>字符串拼接是前端开发中的常规操作，但在大规模数据的循环迭代中进行字符串拼接时，可能稍不慎就会造成造成严重的性能委托。<br>当我们在处理单次或少量字符串拼接时，这些方法的运行速度都很快，根据自己偏好使用即可。但是当字符串拼接的次数很多时，比如循环迭代，那么就需要使用到优化方法。如下是一个字符串迭代拼接的处理过程：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">  str += <span class="string">&quot;a&quot;</span> + <span class="string">&quot;b&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上述代码中，单看循环内部的字符串拼接操作，其代码运行过程可分为四步：<strong>首先在内存中创建一个临时的字符串变量,然后将拼接的字符串’ab’赋值给这个临时变量,接着再把该临时变量和<code>str</code>的当前值进行拼接，最后将结果赋值给<code>str</code>。</strong>可见由于存在临时变量的存取，其性能并不满足预期，<strong>若避免临时变量存取直接向<code>str</code>变量上拼接，在大部分浏览器中，都能将这一操作步骤的执行速度提升 20%左右。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不生成中间临时变量的字符串拼接</span></span><br><span class="line">str = str + <span class="string">&quot;a&quot;</span> + <span class="string">&quot;b&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>还有一些比使用赋值表达式实现字符串拼接稍慢的方法。例如，使用<code>concat()</code>、<code>join()</code>等方法。这些方法优点是使用起来较为灵活，但是缺点是性能比赋值表达式略低。</p>
<hr>
<h5 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h5><p>后续更新</p>
<hr>
<h2 id="六丶构建优化"><a href="#六丶构建优化" class="headerlink" title="六丶构建优化"></a>六丶构建优化</h2><h3 id="6-1-压缩与合并"><a href="#6-1-压缩与合并" class="headerlink" title="6.1 压缩与合并"></a>6.1 压缩与合并</h3><p>资源的压缩和和合并所涉及的优点包括两个方面：一方面是减少<code>HTTP</code>的请求数量,另一方面是减少<code>HTTP</code>请求资源的大小。下面记录一下<code>HTTP</code>压缩、<code>CSS</code>压缩、<code>JavaScript</code></p>
<hr>
<h4 id="HTML-压缩"><a href="#HTML-压缩" class="headerlink" title="HTML 压缩"></a>HTML 压缩</h4><p>打开百度的源代码，会发现<code>HTML</code>代码并没有压缩，其中还包含了空格、回车。虽然这些格式化的字符带来了很好的代码可读性，但是浏览器解析的过程来说并不需要，反而会增加资源的开销。<br><code>HTML</code>压缩就是要删除在文本文件中有意义的，但是在<code>HTML</code>并不参与解析的字符。</p>
<hr>
<h4 id="如何压缩"><a href="#如何压缩" class="headerlink" title="如何压缩"></a>如何压缩</h4><p>常见的压缩方式有三种，这里简单讲讲，实际上基本不会使用这种方式，因为目前绝大多数公司的商业级项目都是使用构建工具进行构建的，后面会详细介绍一下<code>Webpack</code>。</p>
<ul>
<li>使用一些在线网站提供的<code>HTML</code>压缩服务。</li>
<li>使用<code>nodejs</code>所提供的<code>html-minifier</code>工具进行压缩。</li>
<li>服务器端模版引擎的渲染压缩。</li>
</ul>
<hr>
<h4 id="CSS-压缩"><a href="#CSS-压缩" class="headerlink" title="CSS 压缩"></a>CSS 压缩</h4><p><code>CSS</code>的压缩同<code>HTML</code>一样，都是对无效代码的删除，比如注释和无效字符；然后是<code>CSS</code>语义的合并，通常我们写的 css 可能由于文件层级的嵌套，会有一定的语义重复，所以需要进行语义合并。<br>**可以使用<code>html-minifier</code>或者<code>clean-css</code>**等依赖进行压缩处理。</p>
<hr>
<h4 id="JavaScript-压缩与混淆"><a href="#JavaScript-压缩与混淆" class="headerlink" title="JavaScript 压缩与混淆"></a>JavaScript 压缩与混淆</h4><p><code>JavaScript</code>部分的处理主要包括三个方面：</p>
<ol>
<li>无效字符和注释的删除</li>
<li>代码语义缩减和优化</li>
<li>代码混淆保护</li>
</ol>
<p>这里简单说说代码语义缩减和优化及代码混淆保护。</p>
<h5 id="代码语义缩减和优化"><a href="#代码语义缩减和优化" class="headerlink" title="代码语义缩减和优化"></a>代码语义缩减和优化</h5><p>通过对<code>JavaScript</code>的压缩可以将一些变量的长度进行缩短，比如将一个很长的变量名经过压缩后，可以用类似 a、b 这种比较短的变量代替，可以进一步有效地缩短<code>JavaScript</code>的代码量。同样还可以对一些重复代码进行优化，将一些无效代码进行缩短与合并优化。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//未对本次赋值的a进行任何使用，又进行了多余的赋值操作</span></span><br><span class="line">a = <span class="number">2</span>;</span><br><span class="line"><span class="comment">//经过优化变成</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="代码混淆保护"><a href="#代码混淆保护" class="headerlink" title="代码混淆保护"></a>代码混淆保护</h5><p>由于任何访问到网站的用户，都可以使用浏览器的开发工具查看到当前的<code>JavaScript</code>代码，如果前端代码的语义非常明显，那么理论上就会存在一些威胁系统安全的事情。<br><code>CSS</code>和<code>JavaScript</code>的代码量比<code>HTML</code>多很多，代码量进行压缩后，带来流量的减少会非常明显。所以<code>HTML</code>的压缩可有可无，但是<code>CSS</code>与<code>JavaScript</code>压缩却是必须要进行的。</p>
<hr>
<h5 id="如何压缩-1"><a href="#如何压缩-1" class="headerlink" title="如何压缩"></a>如何压缩</h5><p><code>JavaScript</code>压缩处理类似第三方库：<code>uglifyJS2</code>，可以通过包引入使用，这里就不详细介绍了。</p>
<hr>
<h4 id="文件合并"><a href="#文件合并" class="headerlink" title="文件合并"></a>文件合并</h4><p>假设我们有三个<code>JavaScript</code>文件，分别是 a.js、b.js、c.js,当使用<a target="_blank" rel="noopener" href="https://www.cnblogs.com/caoweixiong/p/14720254.html">keep-alive 模式</a>未进行合并请求时，它的请求过程如下图：<img src="/img/loading.gif" data-original="/img/weihebing.png" alt="未合并的请求" title="未合并的请求"><br>先进行三次握手 TCP 建立连接，连接建立好后发出请求获取 a.js 的数据,接收到返回数据后再发出请求获取 b.js 的数据，依次类推，总共需要分三次去获取三份<code>JavaScript</code>文件的数据。如果是合并请求，则只需要发出一个获取 a-b-c.js 的请求就可以接收到全部内容，如图<img src="/img/loading.gif" data-original="/img/hebingqingqiu.png" alt="合并的请求" title="合并的请求"></p>
<h5 id="文件合并的优劣势"><a href="#文件合并的优劣势" class="headerlink" title="文件合并的优劣势"></a>文件合并的优劣势</h5><p>从上面的图不难看出，<strong>不合并请求</strong>相比<strong>合并请求</strong>来说会有以下<strong>缺点</strong>：</p>
<ul>
<li>文件与文件之间有插入的上行请求，所以这增加了一定的网络延迟。</li>
<li>收到网络丢包的影响更加严重，因为每一次的网络请求都有一定概率的丢包可能，获取完所有<code>JavaScript</code>文件存在丢包的概率就会更高。</li>
<li><code>keep-live</code>方式本身也存在一些问题，请求在经过代理服务器时连接有可能会断开，它很难保持<code>keep-live</code>在整个请求过程的状态。</li>
</ul>
<p><strong>合并请求的缺点（重点记一下）</strong>：当经过合并后的<code>JavaScript</code>文件非常大且请求时间比较久时，页面渲染过程就会遭受比较久的延迟。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">AdventurerZzz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/07/23/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">http://example.com/2024/07/23/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Adventurer's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://imgapi.xl0408.top/index.php?9060" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/18/Hexo%E5%A2%9E%E5%8A%A0Live2D%E5%8A%A8%E6%80%81%E4%BA%BA%E7%89%A9/" title="Hexo增加Live2D动态人物"><img class="cover" src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?6056" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hexo增加Live2D动态人物</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/23/My-New-Post/" title="My New Post"><img class="cover" src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?1530" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">My New Post</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/favicon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">AdventurerZzz</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/AdventurerZzz"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Welcome! 欢迎来到我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">前端性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%B8%B6%E5%88%9D%E8%AF%86%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.2.</span> <span class="toc-text">一丶初识性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD%E7%9A%84%E6%AD%A5%E9%AA%A4%E4%B8%80%E8%88%AC%E5%88%86%E4%B8%BA%E4%B8%89%E6%AD%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">常见的优化性能的步骤一般分为三步:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E4%B8%B6%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.3.</span> <span class="toc-text">二丶前端页面的生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%90%AF"><span class="toc-number">1.3.1.</span> <span class="toc-text">网络请求线程开启</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-HTTP-%E8%AF%B7%E6%B1%82"><span class="toc-number">1.3.2.</span> <span class="toc-text">建立 HTTP 请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS-%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">DNS 解析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E7%9A%84%E4%BA%A4%E4%BA%92"><span class="toc-number">1.3.3.</span> <span class="toc-text">前后端的交互</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">反向代理服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">浏览器缓存</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%B8%B2%E6%9F%93%E8%B7%AF%E5%BE%84"><span class="toc-number">1.3.4.</span> <span class="toc-text">关键渲染路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E4%B8%B6%E5%9B%BE%E5%83%8F%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">三丶图像优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%9B%BE%E5%83%8F%E5%9F%BA%E7%A1%80"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1 图像基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A2%E9%87%8F%E5%9B%BE"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">矢量图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%8D%E5%9B%BE"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">位图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%9B%BE%E5%83%8F%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2 图像格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JPEG"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">JPEG</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%B8%90%E8%BF%9B%E5%BC%8F-JPEG"><span class="toc-number">1.4.2.1.1.</span> <span class="toc-text">创建渐进式 JPEG</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GIF"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">GIF</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#GIF-%E5%8A%A8%E7%94%BB%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.2.2.1.</span> <span class="toc-text">GIF 动画优化</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PNG"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">PNG</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%98%E5%8C%96-PNG"><span class="toc-number">1.4.2.3.1.</span> <span class="toc-text">优化 PNG</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WEBP"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">WEBP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#WebP-%E8%BD%AC%E5%8C%96"><span class="toc-number">1.4.2.4.1.</span> <span class="toc-text">WebP 转化</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Base64"><span class="toc-number">1.4.2.5.</span> <span class="toc-text">Base64</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.3 使用建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS-Sprite"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">CSS Sprite</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Web-%E5%AD%97%E4%BD%93"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">Web 字体</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E4%B8%B6%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.5.</span> <span class="toc-text">四丶加载优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%9B%BE%E5%83%8F%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1 图像延迟加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%8A%A0%E8%BD%BD%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.2 加载注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E8%B5%84%E6%BA%90%E5%8D%A0%E4%BD%8D"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">4.2.1 资源占位</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E8%B5%84%E6%BA%90%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.5.3.</span> <span class="toc-text">4.3 资源优先级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">4.3.1 优先级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E9%A2%84%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">4.3.2 预加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-%E9%A2%84%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">4.3.3 预连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-4-%E9%A2%84%E8%8E%B7%E5%8F%96"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">4.3.4 预获取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E4%B8%B6%E4%B9%A6%E5%86%99%E9%AB%98%E6%80%A7%E8%83%BD%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">1.6.</span> <span class="toc-text">五丶书写高性能的代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96"><span class="toc-number">1.6.1.</span> <span class="toc-text">5.1 数据存取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96%E6%96%B9%E5%BC%8F"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">5.1.1 数据存取方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">5.1.2 作用域和作用域链</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-%E5%AE%9E%E6%88%98%E7%BB%8F%E9%AA%8C"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">5.1.3 实战经验</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.6.1.3.1.</span> <span class="toc-text">对局部变量的使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AD%A6%E6%83%95%E9%97%AD%E5%8C%85%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.6.1.3.2.</span> <span class="toc-text">警惕闭包的使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">1.6.2.</span> <span class="toc-text">5.2 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">5.2.1 条件判断</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#if-else-%E5%92%8C-switch"><span class="toc-number">1.6.2.1.1.</span> <span class="toc-text">if-else 和 switch</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#if-else-%E4%BC%98%E5%8C%96"><span class="toc-number">1.6.2.1.2.</span> <span class="toc-text">if-else 优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E7%B4%A2%E5%BC%95%E5%92%8C%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7"><span class="toc-number">1.6.2.1.3.</span> <span class="toc-text">数组索引和对象属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.6.2.1.4.</span> <span class="toc-text">策略模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5"><span class="toc-number">1.6.3.</span> <span class="toc-text">5.3 字符串拼接</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.6.3.0.1.</span> <span class="toc-text">正则表达式</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E4%B8%B6%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">1.7.</span> <span class="toc-text">六丶构建优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%8E%8B%E7%BC%A9%E4%B8%8E%E5%90%88%E5%B9%B6"><span class="toc-number">1.7.1.</span> <span class="toc-text">6.1 压缩与合并</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML-%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">HTML 压缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">如何压缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS-%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">CSS 压缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-%E5%8E%8B%E7%BC%A9%E4%B8%8E%E6%B7%B7%E6%B7%86"><span class="toc-number">1.7.1.4.</span> <span class="toc-text">JavaScript 压缩与混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%AD%E4%B9%89%E7%BC%A9%E5%87%8F%E5%92%8C%E4%BC%98%E5%8C%96"><span class="toc-number">1.7.1.4.1.</span> <span class="toc-text">代码语义缩减和优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E4%BF%9D%E6%8A%A4"><span class="toc-number">1.7.1.4.2.</span> <span class="toc-text">代码混淆保护</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%8E%8B%E7%BC%A9-1"><span class="toc-number">1.7.1.4.3.</span> <span class="toc-text">如何压缩</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6"><span class="toc-number">1.7.1.5.</span> <span class="toc-text">文件合并</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6%E7%9A%84%E4%BC%98%E5%8A%A3%E5%8A%BF"><span class="toc-number">1.7.1.5.1.</span> <span class="toc-text">文件合并的优劣势</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/13/%E5%89%8D%E7%AB%AF%E4%B8%8B%E8%BD%BD%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9E%E6%96%87%E4%BB%B6%E6%B5%81%EF%BC%8C%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" title="前端下载后端返回文件流，踩坑记录"><img src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?3059" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前端下载后端返回文件流，踩坑记录"/></a><div class="content"><a class="title" href="/2024/12/13/%E5%89%8D%E7%AB%AF%E4%B8%8B%E8%BD%BD%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9E%E6%96%87%E4%BB%B6%E6%B5%81%EF%BC%8C%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" title="前端下载后端返回文件流，踩坑记录">前端下载后端返回文件流，踩坑记录</a><time datetime="2024-12-13T02:02:48.000Z" title="发表于 2024-12-13 10:02:48">2024-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/24/%E4%BC%98%E5%8C%96axios%E5%B0%81%E8%A3%85%E4%B9%8B%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8AbortController%E5%8F%96%E6%B6%88%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82/" title="优化axios封装之配置使用AbortController取消重复请求"><img src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?6795" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优化axios封装之配置使用AbortController取消重复请求"/></a><div class="content"><a class="title" href="/2024/09/24/%E4%BC%98%E5%8C%96axios%E5%B0%81%E8%A3%85%E4%B9%8B%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8AbortController%E5%8F%96%E6%B6%88%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82/" title="优化axios封装之配置使用AbortController取消重复请求">优化axios封装之配置使用AbortController取消重复请求</a><time datetime="2024-09-24T09:21:14.000Z" title="发表于 2024-09-24 17:21:14">2024-09-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/18/Hexo%E5%A2%9E%E5%8A%A0Live2D%E5%8A%A8%E6%80%81%E4%BA%BA%E7%89%A9/" title="Hexo增加Live2D动态人物"><img src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?6056" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo增加Live2D动态人物"/></a><div class="content"><a class="title" href="/2024/09/18/Hexo%E5%A2%9E%E5%8A%A0Live2D%E5%8A%A8%E6%80%81%E4%BA%BA%E7%89%A9/" title="Hexo增加Live2D动态人物">Hexo增加Live2D动态人物</a><time datetime="2024-09-18T07:30:52.000Z" title="发表于 2024-09-18 15:30:52">2024-09-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/23/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化"><img src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?9060" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="性能优化"/></a><div class="content"><a class="title" href="/2024/07/23/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化">性能优化</a><time datetime="2024-07-23T02:03:16.000Z" title="发表于 2024-07-23 10:03:16">2024-07-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/23/My-New-Post/" title="My New Post"><img src="/img/loading.gif" data-original="https://imgapi.xl0408.top/index.php?1530" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="My New Post"/></a><div class="content"><a class="title" href="/2024/07/23/My-New-Post/" title="My New Post">My New Post</a><time datetime="2024-07-23T01:37:07.000Z" title="发表于 2024-07-23 09:37:07">2024-07-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By AdventurerZzz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.14.0-b3"></script><script src="/js/main.js?v=4.14.0-b3"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(() => {
  const runMermaid = (ele) => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from(ele).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return
    
    codeMermaidEle.forEach(ele => {
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.innerHTML = `<pre class="mermaid-src" hidden>${ele.textContent}</pre>`
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js').then(runMermaidFn)
  }
  
  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script><script src="https://gcore.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="255,255,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://github-calendar-api.meta-code.top/api?user=AdventurerZzz";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="AdventurerZzz";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":150,"height":300,"hOffset":0,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.8},"log":false});</script>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>